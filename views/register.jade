//- 用户注册页面 - register.jade
doctype html
html(lang="zh-CN")
  head
    title 用户注册
    meta(charset="UTF-8")
    meta(name="viewport", content="width=device-width, initial-scale=1.0")
    style.
      body { font-family: '微软雅黑', sans-serif; max-width: 500px; margin: 0 auto; padding: 20px; }
      .form-group { margin-bottom: 15px; }
      label { display: block; margin-bottom: 5px; font-weight: bold; }
      input[type="text"], input[type="email"] {
        width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px;
      }
      .error { color: red; font-size: 14px; margin-top: 5px; }
      button { background: #4285f4; color: white; border: none; padding: 10px 15px; border-radius: 4px; cursor: pointer; }
      button:hover { background: #3367d6; }
    script(src="https://code.jquery.com/jquery-3.6.0.min.js")

  body
    h1 用户注册
    form(action="/register", method="POST")
      .form-group
        label(for="username") 用户名:
        input(type="text", id="username", name="username", required)
      
      .form-group
        label(for="email") 邮箱:
        input(type="email", id="email", name="email", required)
        button(type="button", onclick="sendCode()") 发送验证码
      
      .form-group
        label(for="verifyCode") 验证码:
        input(type="text", id="verifyCode", name="verifyCode", placeholder="输入验证码", required)
      
      button(type="submit") 注册
      
      p 
        | 已有账号? 
        a(href="/login") 立即登录
    
    script.
      function sendCode() {
        const email = document.querySelector('input[name="email"]').value;
        if(!email) {
          alert('请输入邮箱');
          return;
        }
        fetch('/send-code', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify({email})
        })
        .then(res => res.json())
        .then(data => {
          alert(data.message);
        });
      }